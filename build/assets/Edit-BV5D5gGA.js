import{l as w,T as N,q as x,h as S,A as T,m as E,c as L,w as g,o as c,b as t,t as l,a as p,d as C,e as j,u as f,f as u,F as D,x as F,g as v,i as y,p as V}from"./app-0gpYHNfJ.js";import{_ as O}from"./AuthenticatedLayout-DpP4pYyG.js";import{_ as H}from"./InputError-BmnpY-8-.js";import{C as U}from"./vue-select-BRanwOoH.js";const Q={class:"pagetitle"},z={class:"breadcrumb"},G={class:"breadcrumb-item"},J={class:"breadcrumb-item active"},K={class:"section dashboard"},R={class:"row"},W={class:"col-lg-12"},X={class:"card"},Y={class:"card-body"},Z={class:"card-title"},tt={class:"row mb-3"},et={for:"customerSelect",class:"col-sm-2 col-form-label"},st={class:"col-sm-10"},ot={key:0,class:"row mb-3"},at={for:"productTable",class:"col-sm-2 col-form-label"},lt={class:"col-sm-10"},nt={class:"table"},rt=["onInput","onUpdate:modelValue","max"],dt=["onUpdate:modelValue"],ct=["value"],it=["onClick"],ut={class:"row"},mt={class:"col-md-6"},bt={class:"col-md-6"},ht={class:"text-center"},pt=["disabled"],vt={key:0,class:"bi bi-save"},_t={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},qt={__name:"Edit",props:{order:Object,products:Array,customers:Array,translations:Object},setup(e){const i=w(!1),r=e,m=w(r.customers.find(s=>s.id===r.order.customer_id)||null),d=N({id:r.order.id,customer_id:r.order.customer_id,items:r.order.items||[],total_amount:r.order.total_amount||0}),b=x(d.items);x([]);const M=s=>{const a=r.products.find(h=>h.id===s.product_id);a&&(s.price=a.price)},$=s=>{const a=r.products.find(h=>h.id===s.product_id);a&&s.quantity>a.max_quantity&&(s.quantity=a.max_quantity)},_=S(()=>b.reduce((s,a)=>s+a.quantity*a.price,0));T(_,s=>{d.total_amount=s});const I=()=>{b.push({product_id:"",quantity:1,price:0,canadd:"true"})},P=s=>{b.splice(s,1)},A=s=>{m.value=s,d.customer_id=s?s.id:null},B=()=>{i.value=!0,d.items=b,d.put(route("orders.update",d.id),{onSuccess:()=>{i.value=!1},onError:()=>{i.value=!1}})};return(s,a)=>{const h=E("Link");return c(),L(O,{translations:e.translations},{default:g(()=>{var k;return[t("div",Q,[t("h1",null,l(e.translations.edit_order),1),t("nav",null,[t("ol",z,[t("li",G,[p(h,{class:"nav-link",href:s.route("dashboard")},{default:g(()=>[C(l(e.translations.Home),1)]),_:1},8,["href"])]),t("li",J,l(e.translations.edit_order),1)])])]),t("section",K,[t("div",R,[t("div",W,[t("div",X,[t("div",Y,[t("h5",Z,l(e.translations.edit_order),1),t("form",{onSubmit:j(B,["prevent"]),class:"row g-3"},[t("div",tt,[t("label",et,l(e.translations.client),1),t("div",st,[p(f(U),{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=o=>m.value=o),options:e.customers,label:"name","track-by":"id",reduce:o=>({id:o.id,name:o.name}),clearable:!0,placeholder:e.translations.select_customer,onMouseleave:a[1]||(a[1]=o=>A(m.value))},null,8,["modelValue","options","reduce","placeholder"]),p(H,{message:f(d).errors.customer},null,8,["message"])])]),m.value?(c(),u("div",ot,[t("label",at,l(e.translations.products),1),t("div",lt,[t("table",nt,[t("thead",null,[t("tr",null,[t("th",null,l(e.translations.product),1),t("th",null,l(e.translations.quantity),1),t("th",null,l(e.translations.price),1),t("th",null,l(e.translations.total),1),t("th",null,l(e.translations.actions),1)])]),t("tbody",null,[(c(!0),u(D,null,F(b,(o,q)=>(c(),u("tr",{key:q},[p(f(U),{modelValue:o.product_id,"onUpdate:modelValue":n=>o.product_id=n,options:e.products,label:"name",disabled:o.canadd!="true",reduce:n=>n.id,placeholder:e.translations.select_product,class:"form-control",style:{"min-width":"200px"},onMouseleave:n=>M(o)},null,8,["modelValue","onUpdate:modelValue","options","disabled","reduce","placeholder","onMouseleave"]),t("td",null,[y(t("input",{type:"number",onInput:n=>$(o),"onUpdate:modelValue":n=>o.quantity=n,min:"1",max:o.max_quantity,class:"form-control",placeholder:"Quantity"},null,40,rt),[[V,o.quantity]])]),t("td",null,[y(t("input",{type:"number","onUpdate:modelValue":n=>o.price=n,min:"0",class:"form-control",placeholder:"Price"},null,8,dt),[[V,o.price]])]),t("td",null,[t("input",{type:"number",value:o.quantity*o.price,class:"form-control",disabled:""},null,8,ct)]),t("td",null,[t("button",{type:"button",class:"btn btn-danger",onClick:n=>P(q)},a[3]||(a[3]=[t("i",{class:"bi bi-trash"},null,-1)]),8,it)])]))),128))])]),(k=e.products)!=null&&k.length?(c(),u("button",{key:0,type:"button",class:"btn btn-primary",onClick:I},l(e.translations.add_product),1)):v("",!0)])])):v("",!0),t("div",ut,[t("div",mt,[t("strong",null,l(e.translations.total)+":",1)]),t("div",bt,[y(t("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=o=>_.value=o),class:"form-control",readonly:""},null,512),[[V,_.value]])])]),t("div",ht,[t("button",{type:"submit",class:"btn btn-primary",disabled:i.value},[C(l(e.translations.save)+" Â  ",1),i.value?v("",!0):(c(),u("i",vt)),i.value?(c(),u("span",_t)):v("",!0)],8,pt)])],32)])])])])])]}),_:1},8,["translations"])}}};export{qt as default};
